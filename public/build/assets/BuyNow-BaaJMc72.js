import{aS as r,aQ as O,q as F,aC as H,bC as h,aX as R,u as d,aK as c,v as a,I as u,bH as I,bi as f,b9 as o,at as S,t as P,bJ as $,by as q,bw as M,F as z,aV as J,g as K}from"./vendor-Cy4BBKy_.js";import{a as Q}from"./utilities-STV8t6c4.js";import{_ as W,B as X}from"./BuyNowCheckoutProduct-BK3Q-9g5.js";import{C as Y}from"./CheckoutShippingAddress-CrpHQ2Se.js";import{_ as Z,a as ee,u as se,b as ae}from"./app-i4sZYluG.js";import{a as te}from"./framework-C9q9PHhQ.js";import{_ as oe,s as re}from"./ui-BDBDEXQQ.js";import"./icons-DjuF0c5-.js";import"./OrderConfirmModal-CZSsDKcX.js";import"./VerifyOtpModal-qTJEUh5g.js";const ne={class:"main-container"},le={class:"flex items-center gap-2 overflow-hidden pt-4"},ie={class:"grow w-full overflow-hidden"},de={class:"space-x-1 text-slate-600 text-sm font-normal truncate"},ce={class:"grid grid-cols-1 xl:grid-cols-3 my-3 gap-8"},ue={class:"col-span-1 xl:col-span-2"},ve={class:"flex gap-2 justify-between items-center"},me={class:"text-slate-950 text-lg sm:text-3xl font-medium leading-10"},pe={class:"text-primary-600 text-lg font-medium leading-normal tracking-tight"},he={key:0},fe={class:"mt-6"},ye={class:"mb-1"},_e={class:"text-slate-950 text-xl font-medium leading-7"},ge={class:"text-slate-500 text-lg font-normal leading-7 tracking-tight"},be=["placeholder"],we={class:"p-6 mt-4 bg-white rounded-2xl border border-slate-200"},xe={class:"text-slate-950 text-xl font-medium leading-7"},ke={class:"mt-4 flex flex-wrap gap-4"},Ce={key:0,for:"cash",class:"flex items-center gap-4 xl:min-w-80"},Pe={class:"text-slate-500 text-base font-normal leading-normal"},$e={key:1,for:"card",class:"flex items-center gap-4 xl:min-w-80"},Ne={class:"text-slate-500 text-base font-normal leading-normal"},Be={key:0,class:"mt-5 border-t border-slate-200"},Ae={class:"text-slate-600 pt-2 block text-md font-medium leading-7"},Me={class:"mt-3 flex flex-wrap gap-4"},Le=["for"],Ve=["id","value"],De={class:""},Oe=["src"],Ie={__name:"BuyNow",setup(Se){const U=new te,j=ee(),v=se(),w=ae(),y=r(!0),N=r(""),G=v.cashOnDelivery?"cash":"card",n=r(G),_=r(null),g=r(null),l=O({shop_ids:[],address:{area:"",nearest_landmark:""}}),m=r({}),i=r({}),x=r(0),B=r(""),k=r(""),b=r(""),L=O({province:"",area:""});F(()=>Object.values(L).some(e=>e!==""));async function V(e){try{const{data:s}=await Q.get(`/shop/${e}/provinces-delivery-charges`);return s.data||[]}catch(s){return console.error("Error fetching provinces:",s),[]}}const A=async()=>{let e=0;for(const s of l.shop_ids){const C=m.value[s]||[],t=i.value[s],p=C.find(E=>E.id==t);e+=p?Number(p.delivery_charge):0}x.value=e},T=(e,s)=>{e&&(L.province="");const t=(m.value[s]||[]).find(p=>p.id==e);t&&(l.address.area=t.province_name,B.value=t.province_name,k.value=t.province_name,b.value=l.address.nearest_landmark),A()};function D(e){try{return v.showCurrency?v.showCurrency(e):e}catch{return e}}return H(async()=>{if(window.scrollTo(0,0),w.coupon_code="",_.value=n.value,!j.user){U.push({name:"home"});return}if(w.buyNowProduct){const e=w.buyNowProduct.shop_id;l.shop_ids=[e];const s=await V(e);m.value[e]=s,await A()}}),h(n,()=>{n.value==="card"?_.value=g.value:_.value=n.value}),h(g,()=>{n.value==="card"&&(_.value=g.value)}),h(()=>l.shop_ids,async e=>{if(e.length>0){for(const s of e)m.value[s]=await V(s);for(const s of e)i.value[s]||(i.value[s]="");x.value=0}else m.value={},i.value={},x.value=0},{deep:!0}),h(i,A,{deep:!0}),h(()=>l.address.nearest_landmark,e=>{b.value=e}),h(()=>l.address.area,e=>{k.value=e,B.value=e}),(e,s)=>{const C=R("router-link");return c(),d("div",ne,[a("div",le,[u(C,{to:"/",class:"w-6 h-6"},{default:I(()=>[u(f(oe),{class:"w-5 h-5 text-slate-600"})]),_:1}),a("div",ie,[a("div",de,[a("span",null,o(e.$t("Home")),1),s[6]||(s[6]=a("span",null,"/",-1)),a("span",null,o(e.$t("Cart")),1),s[7]||(s[7]=a("span",null,"/",-1)),a("span",null,o(e.$t("Checkout")),1)])])]),a("div",ce,[a("div",ue,[a("div",{class:S(["py-4 border-b tran",y.value?"border-primary":"border-slate-200"])},[a("div",ve,[a("div",me,o(e.$t("Checkout")),1),a("div",{class:"flex items-center gap-2 cursor-pointer",onClick:s[0]||(s[0]=t=>y.value=!y.value)},[a("div",pe," ("+o(f(w).buyNowProduct?1:0)+" "+o(e.$t("items"))+") ",1),u(f(re),{class:S(["w-5 h-5 text-primary-600 transition duration-300",y.value?"rotate-180":""])},null,8,["class"])])]),y.value?(c(),d("div",he,[u(W)])):P("",!0)],2),u(Y,{shopProvinces:m.value,selectedProvinces:i.value,onChangeProvinces:T,showCurrency:D,provinceArea:k.value,nearestLandmark:b.value,"onUpdate:nearestLandmark":s[1]||(s[1]=t=>b.value=t)},null,8,["shopProvinces","selectedProvinces","provinceArea","nearestLandmark"]),a("div",fe,[a("div",ye,[a("span",_e,o(e.$t("Note")),1),a("span",ge," ("+o(e.$t("Optional"))+") ",1)]),$(a("textarea",{"onUpdate:modelValue":s[2]||(s[2]=t=>N.value=t),rows:"3",class:"form-input",placeholder:e.$t("Write your note here")+"..."},null,8,be),[[q,N.value]])]),a("div",we,[a("div",xe,o(e.$t("Payment Method")),1),a("div",ke,[f(v).cashOnDelivery?(c(),d("label",Ce,[$(a("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>n.value=t),id:"cash",name:"payment",type:"radio",class:"radioBtn2",value:"cash",checked:""},null,512),[[M,n.value]]),s[8]||(s[8]=a("div",{class:"p-2 bg-white rounded-xl border border-slate-200"},[a("img",{src:"assets/icons/money-2.svg",alt:"",class:"w-7 h-7"})],-1)),a("span",Pe,o(e.$t("Cash on delivery")),1)])):P("",!0),f(v).onlinePayment?(c(),d("label",$e,[$(a("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>n.value=t),id:"card",name:"payment",type:"radio",class:"radioBtn2",value:"card"},null,512),[[M,n.value]]),s[9]||(s[9]=a("div",{class:"p-2 bg-white rounded-xl border border-slate-200"},[a("img",{src:"assets/icons/card.svg",alt:"",class:"w-7 h-7"})],-1)),a("span",Ne,o(e.$t("Credit or Debit Card")),1)])):P("",!0)]),u(K,{"leave-active-class":"transition ease-in duration-300","enter-active-class":"transition ease-out duration-300","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:I(()=>[n.value==="card"?(c(),d("div",Be,[a("span",Ae,o(e.$t("Available Payment Gateways")),1),a("div",Me,[(c(!0),d(z,null,J(f(v).paymentGateways,t=>(c(),d("label",{key:t.id,for:t.name,class:"flex items-center gap-4 border relative has-[:checked]:border-primary has-[:checked]:shadow-lg p-2 rounded-md border-slate-200 cursor-pointer"},[$(a("input",{"onUpdate:modelValue":s[5]||(s[5]=p=>g.value=p),id:t.name,name:"paymentGateway",type:"radio",class:"sr-only",value:t.name},null,8,Ve),[[M,g.value]]),a("div",De,[a("img",{src:t.logo,alt:"",class:"w-32 h-16 object-contain"},null,8,Oe)])],8,Le))),128))])])):P("",!0)]),_:1})])]),u(X,{note:N.value,paymentMethod:_.value,deliveryCharge:x.value,selectedProvinces:i.value,provinceName:B.value,provinceArea:k.value,nearestLandmark:b.value,showCurrency:D},null,8,["note","paymentMethod","deliveryCharge","selectedProvinces","provinceName","provinceArea","nearestLandmark"])])])}}},Je=Z(Ie,[["__scopeId","data-v-0afb0ed1"]]);export{Je as default};
